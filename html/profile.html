<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Perfil - Workflow</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/profile.css">
    <link rel="icon" type="image/x-icon" href="../favicon.ico">
    <style>
        .swal2-container {
            z-index: 20000 !important;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="nav">
            <div class="nav-container">
                <div class="nav-brand">
                    <img src="../img/Logo-WorkFlow.jpg" alt="Workflow Logo" class="nav-logo">
                    <span>Consultoría de RRHH</span>
                </div>
                <ul class="nav-menu">
                    <li><a href="../index.html" class="nav-link">Inicio</a></li>
                    <li><a href="jobs.html" class="nav-link">Empleos</a></li>
                    <li><a href="companies.html" class="nav-link">Empresas</a></li>
                    <li><a href="profile.html" class="nav-link active">Mi Perfil</a></li>
                </ul>
                <div class="nav-actions" id="nav-actions">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
        </nav>
    </header>

    <!-- Profile Section -->
    <section class="profile-section">
        <div class="container-fluid">
            <!-- Profile Header -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-body">
                            <div class="row align-items-center">
                                <div class="col-md-3 text-center">
                                    <div class="position-relative d-inline-block">
                                        <img id="profile-image" src="https://images.pexels.com/photos/2379004/pexels-photo-2379004.jpeg?auto=compress&cs=tinysrgb&w=150" 
                                             alt="Foto de perfil" class="rounded-circle" style="width: 120px; height: 120px; object-fit: cover;">
                                        <button class="btn btn-sm btn-outline-primary position-absolute bottom-0 end-0" id="change-photo">
                                            <i class="bi bi-camera"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <h2 id="profile-name" class="mb-2">Nombre del Usuario</h2>
                                    <p id="profile-email" class="text-muted mb-2">
                                        <i class="bi bi-envelope"></i> email@ejemplo.com
                                    </p>
                                    <span id="profile-type" class="badge bg-primary mb-2">Candidato</span>
                                    <p id="profile-joined" class="text-muted mb-0">
                                        <i class="bi bi-calendar"></i> Miembro desde: Enero 2024
                                    </p>
                                </div>
                                <div class="col-md-3 text-end">
                                    <button class="btn btn-primary mb-2" id="edit-profile">
                                        <i class="bi bi-pencil"></i> Editar Perfil
                                    </button>
                                    <button class="btn btn-outline-secondary" id="download-cv">
                                        <i class="bi bi-download"></i> Descargar CV
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Profile Content -->
            <div class="row">
                <div class="col-12">
                    <div class="card">
                        <div class="card-body">
                            <!-- Navigation Tabs -->
                            <ul class="nav nav-tabs" id="profileTabs" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link active" id="overview-tab" data-bs-toggle="tab" data-bs-target="#overview" type="button" role="tab">
                                        <i class="bi bi-house"></i> Resumen
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="applications-tab" data-bs-toggle="tab" data-bs-target="#applications" type="button" role="tab">
                                        <i class="bi bi-file-earmark-text"></i> Mis Aplicaciones
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="favorites-tab" data-bs-toggle="tab" data-bs-target="#favorites" type="button" role="tab">
                                        <i class="bi bi-heart"></i> Favoritos
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="cv-tab" data-bs-toggle="tab" data-bs-target="#cv" type="button" role="tab">
                                        <i class="bi bi-file-earmark-person"></i> Mi CV
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="settings-tab" data-bs-toggle="tab" data-bs-target="#settings" type="button" role="tab">
                                        <i class="bi bi-gear"></i> Configuración
                                    </button>
                                </li>
                            </ul>

                            <!-- Tab Content -->
                            <div class="tab-content" id="profileTabsContent">
                                <!-- Overview Tab -->
                                <div class="tab-pane fade show active" id="overview" role="tabpanel">
                                    <div class="row mt-4">
                                        <!-- Statistics Cards -->
                                        <div class="col-md-3 col-sm-6 mb-3">
                                            <div class="card text-center h-100">
                                                <div class="card-body">
                                                    <i class="bi bi-file-earmark-text text-primary" style="font-size: 2rem;"></i>
                                                    <h4 class="mt-2" id="total-applications">0</h4>
                                                    <p class="text-muted mb-0">Aplicaciones Enviadas</p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-3 col-sm-6 mb-3">
                                            <div class="card text-center h-100">
                                                <div class="card-body">
                                                    <i class="bi bi-clock text-warning" style="font-size: 2rem;"></i>
                                                    <h4 class="mt-2" id="pending-applications">0</h4>
                                                    <p class="text-muted mb-0">En Proceso</p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-3 col-sm-6 mb-3">
                                            <div class="card text-center h-100">
                                                <div class="card-body">
                                                    <i class="bi bi-camera-video text-info" style="font-size: 2rem;"></i>
                                                    <h4 class="mt-2" id="interviews">0</h4>
                                                    <p class="text-muted mb-0">Entrevistas</p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-3 col-sm-6 mb-3">
                                            <div class="card text-center h-100">
                                                <div class="card-body">
                                                    <i class="bi bi-person-check text-success" style="font-size: 2rem;"></i>
                                                    <h4 class="mt-2" id="profile-completion">60%</h4>
                                                    <p class="text-muted mb-0">Perfil Completado</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Recent Activity -->
                                    <div class="row mt-4">
                                        <div class="col-12">
                                            <h5><i class="bi bi-activity"></i> Actividad Reciente</h5>
                                            <div id="recent-activities">
                                                <!-- Will be populated by JavaScript -->
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Applications Tab -->
                                <div class="tab-pane fade" id="applications" role="tabpanel">
                                    <div class="mt-4">
                                        <div class="d-flex justify-content-between align-items-center mb-3">
                                            <h5><i class="bi bi-file-earmark-text"></i> Mis Aplicaciones</h5>
                                            <div class="btn-group" role="group">
                                                <button class="btn btn-outline-primary active" data-filter="all">Todas</button>
                                                <button class="btn btn-outline-primary" data-filter="pending">En Proceso</button>
                                                <button class="btn btn-outline-primary" data-filter="interview">Entrevista</button>
                                                <button class="btn btn-outline-primary" data-filter="rejected">Rechazadas</button>
                                            </div>
                                        </div>
                                        <div id="applications-list" class="row g-3">
                                            <!-- Will be populated by JavaScript -->
                                        </div>
                                    </div>
                                </div>

                                <!-- Favorites Tab -->
                                <div class="tab-pane fade" id="favorites" role="tabpanel">
                                    <div class="mt-4">
                                        <h5><i class="bi bi-heart"></i> Favoritos</h5>
                                        <div id="favorites-list" class="row g-3">
                                            <!-- Will be populated by JavaScript -->
                                        </div>
                                    </div>
                                </div>

                                <!-- CV Tab -->
                                <div class="tab-pane fade" id="cv" role="tabpanel">
                                    <div class="mt-4">
                                        <h5><i class="bi bi-file-earmark-person"></i> Mi Currículum Vitae</h5>
                                        
                                        <!-- CV Upload Section -->
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="card">
                                                    <div class="card-body text-center">
                                                        <i class="bi bi-cloud-upload text-primary" style="font-size: 3rem;"></i>
                                                        <h6 class="mt-3">Sube tu CV</h6>
                                                        <p class="text-muted">Arrastra y suelta tu archivo aquí o haz clic para seleccionar</p>
                                                        <input type="file" id="cv-file" accept=".pdf,.doc,.docx" hidden>
                                                        <button class="btn btn-primary" onclick="document.getElementById('cv-file').click()">
                                                            <i class="bi bi-upload"></i> Seleccionar Archivo
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="card">
                                                    <div class="card-body text-center">
                                                        <i class="bi bi-pencil-square text-success" style="font-size: 3rem;"></i>
                                                        <h6 class="mt-3">Crear CV</h6>
                                                        <p class="text-muted">¿No tienes un CV? Usa nuestro constructor gratuito</p>
                                                        <button class="btn btn-outline-success" id="cv-builder-btn">
                                                            <i class="bi bi-plus-circle"></i> Crear CV
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- CV Constructor (hidden by default) -->
                                        <div id="constructor-cv" class="mt-4" style="display:none;">
                                            <div class="card">
                                                <div class="card-body">
                                                    <h6><i class="bi bi-pencil-square"></i> Constructor de CV</h6>
                                                    <form id="cv-constructor-form">
                                                        <div class="row">
                                                            <div class="col-md-6 mb-3">
                                                                <label for="cv-nombre" class="form-label">Nombre Completo</label>
                                                                <input type="text" class="form-control" id="cv-nombre" required>
                                                            </div>
                                                            <div class="col-md-6 mb-3">
                                                                <label for="cv-email" class="form-label">Email</label>
                                                                <input type="email" class="form-control" id="cv-email" required>
                                                            </div>
                                                            <div class="col-12 mb-3">
                                                                <label for="cv-experiencia" class="form-label">Experiencia Laboral</label>
                                                                <textarea class="form-control" id="cv-experiencia" rows="3" required></textarea>
                                                            </div>
                                                            <div class="col-12 mb-3">
                                                                <label for="cv-educacion" class="form-label">Educación</label>
                                                                <textarea class="form-control" id="cv-educacion" rows="2" required></textarea>
                                                            </div>
                                                            <div class="col-12 mb-3">
                                                                <label for="cv-habilidades" class="form-label">Habilidades</label>
                                                                <input type="text" class="form-control" id="cv-habilidades" placeholder="Ej: JavaScript, Liderazgo" required>
                                                            </div>
                                                            <div class="col-12">
                                                                <button type="submit" class="btn btn-success">
                                                                    <i class="bi bi-check-circle"></i> Guardar CV
                                                                </button>
                                                                <button type="button" class="btn btn-secondary ms-2" id="volver-cv">
                                                                    <i class="bi bi-arrow-left"></i> Volver
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Settings Tab -->
                                <div class="tab-pane fade" id="settings" role="tabpanel">
                                    <div class="mt-4">
                                        <h5><i class="bi bi-gear"></i> Configuración de la Cuenta</h5>
                                        
                                        <div class="row">
                                            <div class="col-md-8">
                                                <div class="card">
                                                    <div class="card-body">
                                                        <form id="settings-form">
                                                            <div class="row">
                                                                <div class="col-md-6 mb-3">
                                                                    <label for="settings-name" class="form-label">Nombre Completo</label>
                                                                    <input type="text" class="form-control" id="settings-name" name="name" required>
                                                                </div>
                                                                <div class="col-md-6 mb-3">
                                                                    <label for="settings-email" class="form-label">Email</label>
                                                                    <input type="email" class="form-control" id="settings-email" name="email" required>
                                                                </div>
                                                                <div class="col-md-6 mb-3">
                                                                    <label for="settings-phone" class="form-label">Teléfono</label>
                                                                    <input type="tel" class="form-control" id="settings-phone" name="phone">
                                                                </div>
                                                                <div class="col-md-6 mb-3">
                                                                    <label for="settings-location" class="form-label">Ubicación</label>
                                                                    <div class="input-group">
                                                                        <input type="text" class="form-control" id="settings-location" name="location" placeholder="Ciudad, País" readonly>
                                                                        <button type="button" class="btn btn-outline-secondary" id="open-city-modal">
                                                                            <i class="bi bi-geo-alt"></i>
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                                <div class="col-12 mb-3">
                                                                    <label for="settings-bio" class="form-label">Biografía</label>
                                                                    <textarea class="form-control" id="settings-bio" name="bio" rows="4" placeholder="Cuéntanos sobre ti..."></textarea>
                                                                </div>
                                                                <div class="col-12">
                                                                    <button type="submit" class="btn btn-primary">
                                                                        <i class="bi bi-check-circle"></i> Guardar Cambios
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="col-md-4">
                                                <div class="card">
                                                    <div class="card-body">
                                                        <h6><i class="bi bi-bell"></i> Notificaciones</h6>
                                                        <div class="form-check form-switch mb-3">
                                                            <input class="form-check-input" type="checkbox" id="email-notifications" checked>
                                                            <label class="form-check-label" for="email-notifications">
                                                                <strong>Notificaciones por Email</strong>
                                                                <br><small class="text-muted">Recibe actualizaciones sobre tus aplicaciones</small>
                                                            </label>
                                                        </div>
                                                        <div class="form-check form-switch">
                                                            <input class="form-check-input" type="checkbox" id="job-alerts" checked>
                                                            <label class="form-check-label" for="job-alerts">
                                                                <strong>Alertas de Empleos</strong>
                                                                <br><small class="text-muted">Notificaciones de nuevos empleos que coincidan con tu perfil</small>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Modal Selección de Ciudad -->
    <div class="modal fade" id="city-modal" tabindex="-1" aria-labelledby="cityModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="cityModalLabel">
                        <i class="bi bi-geo-alt"></i> Selecciona tu ciudad
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <select id="city-select" class="form-select">
                        <option value="">Elige una ciudad</option>
                        <option value="Lima">Lima</option>
                        <option value="Arequipa">Arequipa</option>
                        <option value="Trujillo">Trujillo</option>
                        <option value="Cusco">Cusco</option>
                        <option value="Piura">Piura</option>
                        <option value="Chiclayo">Chiclayo</option>
                        <option value="Iquitos">Iquitos</option>
                        <option value="Tacna">Tacna</option>
                        <option value="Huancayo">Huancayo</option>
                        <option value="Puno">Puno</option>
                        <option value="Chimbote">Chimbote</option>
                        <option value="Juliaca">Juliaca</option>
                        <option value="Sullana">Sullana</option>
                        <option value="Ica">Ica</option>
                        <option value="Ayacucho">Ayacucho</option>
                    </select>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="save-city">
                        <i class="bi bi-check-circle"></i> Guardar ciudad
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Detalles de Oferta -->
    <div class="modal fade" id="offer-modal" tabindex="-1" aria-labelledby="offerModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="offerModalLabel">Detalles de la Oferta</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="offer-details-content">
                    <!-- Detalles de la oferta -->
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../js/auth.js"></script>
    <script src="../js/profile.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</body>
</html>

